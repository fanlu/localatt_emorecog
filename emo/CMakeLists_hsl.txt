cmake_minimum_required(VERSION 3.0 FATAL_ERROR)
project(custom_ops)

# list(APPEND CMAKE_PREFIX_PATH "/Users/fanlu/workspace/workspace/mklml_mac_2019.0.3.20190220")
# list(APPEND CMAKE_PREFIX_PATH "/mnt/cephfs2/asr/users/fanlu/libtorch")
foreach(path ${CMAKE_PREFIX_PATH})
  message("Path: " ${path})
endforeach(path)

# set(KALDI_ROOT "/mnt/cephfs2/asr/users/fanlu/kaldi")
set(KALDI_ROOT "/mnt/cephfs2/asr/users/huangshanluo/kaldi/kaldi/")
include_directories(${KALDI_ROOT}/src ${KALDI_ROOT}/tools/openfst/include)
link_directories(${KALDI_ROOT}/src/lib ${KALDI_ROOT}/tools/openfst/lib)

set(TORCH_DIR "/mnt/cephfs2/asr/users/fanlu/libtorch")
include_directories(${TORCH_DIR}/include)
link_directories(${TORCH_DIR}/lib)
# find_package(Torch REQUIRED)

# add_executable(inference inference.cpp)
# target_link_libraries(inference "${TORCH_LIBRARIES}")
# set_property(TARGET inference PROPERTY CXX_STANDARD 11)

# add_executable(emo emo.cc)
# target_link_libraries(emo pthread fst kaldi-base kaldi-gmm kaldi-matrix kaldi-sgmm2 kaldi-chain kaldi-hmm kaldi-nnet2 kaldi-transform kaldi-cudamatrix kaldi-ivector kaldi-nnet3 kaldi-tree kaldi-decoder kaldi-kws kaldi-nnet kaldi-util kaldi-feat kaldi-lat kaldi-online2 kaldi-fstext kaldi-lm kaldi-rnnlm)
# set_property(TARGET emo PROPERTY CXX_STANDARD 11)

add_executable(emo2 emo2.cc)
target_link_libraries(emo2 torch caffe2 c10 pthread fst kaldi-base kaldi-gmm kaldi-matrix kaldi-sgmm2 kaldi-chain kaldi-hmm kaldi-nnet2 kaldi-transform kaldi-cudamatrix kaldi-ivector kaldi-nnet3 kaldi-tree kaldi-decoder kaldi-kws kaldi-nnet kaldi-util kaldi-feat kaldi-lat kaldi-online2 kaldi-fstext kaldi-lm kaldi-rnnlm)
# set_property(TARGET emo2 PROPERTY INTERFACE_COMPILE_OPTIONS "-D_GLIBCXX_USE_CXX11_ABI=1")
# add_definitions(-D_GLIBCXX_USE_CXX11_ABI=0)
set_property(TARGET emo2 PROPERTY CXX_STANDARD 11)

# add_executable(emo3 emo3.cc)
# target_link_libraries(emo3 pthread fst kaldi-base kaldi-gmm kaldi-matrix kaldi-sgmm2 kaldi-chain kaldi-hmm kaldi-nnet2 kaldi-transform kaldi-cudamatrix kaldi-ivector kaldi-nnet3 kaldi-tree kaldi-decoder kaldi-kws kaldi-nnet kaldi-util kaldi-feat kaldi-lat kaldi-online2 kaldi-fstext kaldi-lm kaldi-rnnlm ${TORCH_LIBRARIES})
# target_link_libraries(emo3 torch)
# target_link_libraries(emo3 libpthread.so libfst.so libkaldi-base.so libkaldi-gmm.so libkaldi-matrix.so libkaldi-sgmm2.so libkaldi-chain.so libkaldi-hmm.so libkaldi-nnet2.so libkaldi-transform.so libkaldi-cudamatrix.so libkaldi-ivector.so libkaldi-nnet3.so libkaldi-tree.so libkaldi-decoder.so libkaldi-kws.so libkaldi-nnet.so libkaldi-util.so libkaldi-feat.so libkaldi-lat.so libkaldi-online2.so libkaldi-fstext.so libkaldi-lm.so libkaldi-rnnlm.so)
# target_link_libraries(emo3 pthread)
# target_link_libraries(emo3 kaldi-base)
# target_link_libraries(emo3 kaldi-gmm)
# target_link_libraries(emo3 kaldi-matrix)
# target_link_libraries(emo3 kaldi-sgmm2)
# target_link_libraries(emo3 kaldi-chain)
# target_link_libraries(emo3 kaldi-hmm)
# target_link_libraries(emo3 kaldi-nnet2)
# target_link_libraries(emo3 kaldi-transform)
# target_link_libraries(emo3 kaldi-cudamatrix)
# target_link_libraries(emo3 kaldi-ivector)
# target_link_libraries(emo3 kaldi-nnet3)
# target_link_libraries(emo3 kaldi-tree)
# target_link_libraries(emo3 kaldi-decoder)
# target_link_libraries(emo3 kaldi-kws)
# target_link_libraries(emo3 kaldi-nnet)
# target_link_libraries(emo3 kaldi-util)
# target_link_libraries(emo3 kaldi-feat)
# target_link_libraries(emo3 kaldi-lat)
# target_link_libraries(emo3 kaldi-online2)
# target_link_libraries(emo3 kaldi-fstext)
# target_link_libraries(emo3 kaldi-lm)
# target_link_libraries(emo3 kaldi-rnnlm)
# set_property(TARGET emo3 PROPERTY CXX_STANDARD 11)

